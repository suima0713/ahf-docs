{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "AHF-Lite Record",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "kpi": { "type": "string", "minLength": 1 },
    "claim": { "type": "string", "maxLength": 200 },
    "asof": { "type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}$" },
    "status": { "type": "string", "enum": ["C", "P", "W"] },
    "url": { "type": "string" },
    "ttl_days": { "type": "integer", "minimum": 1, "maximum": 365 },
    "trigger_if_false": { "type": "string" },
    "value": { "type": ["number", "string"] },
    "unit": { "type": "string", "enum": ["USD", "percent", "count", "text", "date"] },
    "note": { "type": "string" }
  },
  "required": ["kpi", "claim", "asof", "status"],
  "oneOf": [
    {
      "properties": {
        "status": { "const": "C" },
        "value": { "type": ["number", "string"] },
        "unit": { "type": "string" }
      },
      "required": ["value", "unit"]
    },
    {
      "properties": {
        "status": { "enum": ["P", "W"] },
        "ttl_days": { "type": "integer" },
        "trigger_if_false": { "type": "string" }
      },
      "required": ["ttl_days", "trigger_if_false"]
    }
  ]
}
