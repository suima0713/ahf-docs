# AHF v0.8.0 チェンジログ

## 概要
AHF v0.8.0は、投資判断に直結する固定3軸で評価するシステムです。

**Purpose**: 投資判断に直結する固定3軸で評価する  
**MVP**: ①②③の名称と順序を固定／T1で確証（不足は n/a）／定型テーブル＋1行要約を即時出力

## 主要変更点

### 1. 固定3軸の導入
- **①長期EV確度（LEC）**: どの環境でも生き残り、需要と利益を生み続ける確度
- **②長期EV勾配（NES）**: 12–24ヶ月の伸び"傾き"（短期加速の手応え）
- **③バリュエーション＋認知ギャップ（VRG）**: 価格（EV/S_actual）に対する"フェア"との差を測り、その差が将来期待や認知で妥当かを注釈

### 2. ワークフローの固定化
- **Intake**: 銘柄候補／T1可用性
- **Stage-1｜Fast-Screen（Core）**: T1逐語≤25語＋#:~:text=
- **Stage-2｜Mini-Confirm（α3/α5）**: T1のみでα3/α5確認
- **Stage-3｜半透明αの最大化**: 固まったT1の地図から違和感→仮説を立て、T1で単一テスト
- **Decision**: DI = (0.6·s2 + 0.4·s1) · Vmult

### 3. 意思決定の固定化
- **正規化**: s1=①★/5、s2=②★/5
- **合成**: DI = (0.6·s2 + 0.4·s1) · Vmult
- **アクション**: GO ≥0.55｜WATCH 0.32–0.55｜NO-GO <0.32
- **サイズ**: Size% ≈ 1.2% × DI

### 4. テンプレートの更新
- `A_v080.yaml`: 材料（固定3軸対応）
- `B_v080.yaml`: 総合判断（Horizon＋ΔIRR＋KPI×2）
- `C_v080.yaml`: 反証（固定3テスト＋Stage-3）
- `facts_v080.md`: T1確定事実（固定3軸タグ対応）
- `triage_v080.json`: トリアージ（固定3軸対応）
- `backlog_v080.md`: E0-UL一元プール（固定3軸対応）

### 5. スクリプトの実装
- `ahf_v080_workflow.py`: ワークフロー実装
- `ahf_v080_evaluator.py`: 評価器実装
- `ahf_v080_turbo_screen.py`: Turbo Screen実装
- `ahf_v080_integrated.py`: 統合評価システム
- `ahf_v080_anchor_lint.py`: AnchorLint v1
- `ahf_v080_math_guard.py`: 数理ガード
- `ahf_v080_s3_lint.py`: S3-Lint
- `test_ahf_v080.py`: 全テストスイート
- `Start-AHFv080Evaluation.ps1`: PowerShell実行スクリプト

### 6. バリデーション機能の強化
- **AnchorLint v1**: 逐語≤25語＋#:~:text=必須、PDFはanchor_backup{pageno,quote,hash}
- **数理ガード**: GM乖離≤0.2pp、残差GP≤$8M、GP/OpEx/ERC/D&Aクロス、OT∈[46.8,61.0]
- **S3-Lint**: Stage-3のLint（L1–L5）

### 7. Turbo Screen（オーバーレイ）
- **受付閾値**: Edge採用 P≥60（CoreはP≥70）
- **TTL**: ≤14日
- **矛盾フラグ**: trueは除外
- **★調整幅**: Screen★は±2★まで（Coreは±1★）
- **確信度ブースト**: ±10ppを1回（Coreは±5pp）
- **数理ガード**: Screenのみ緩和

### 8. Stage-3（半透明αの最大化）
- **意義**: 固まったT1確度の上に、"違和感→仮説→T1テスト"で半透明αを積む
- **S3-MinSpec v1.0**: 固定ルール
- **S3-Lint**: 最小5チェック
- **反映**: ①②は各軸±1★内で調整／③はStep-1（機械）のみで色/Vmult決定

### 9. 制約事項の明確化
- **ChatOps制約**: 非同期禁止・即時回答、T1限定、逐語≤25語＋URLアンカー必須
- **逸脱防止**: 二鍵実行、粒度制限、二重アンカー待機、価格系隔離、曖昧命令の拒否
- **品質管理**: 3分ルール、テスト要件、注意事項

## 技術的詳細

### 計算式
- **LEC**: `LEC ≈ g_fwd + ΔOPM_fwd − Dilution − Capex_intensity`
- **NES**: `NES = 0.5·(次Q q/q%) + 0.3·(ガイド改定%) + 0.2·(受注/Backlog増勢%) + Margin_term + Health_term`
- **VRG Step-1**: `Disc% = (EV/S_fair_base − EV/S_actual) / EV/S_fair_base`
- **DI**: `DI = (0.6·s2 + 0.4·s1) · Vmult`

### 星割当
- **LEC**: ≥+20pp→★5／15–20→★4／8–15→★3／3–8→★2／<3→★1
- **NES**: ≥+8→★5／+5–8→★4／+2–5→★3／0–2→★2／<0→★1

### 色/Vmult
- **Green(1.05)**: Disc%≥+10% または |Disc%|≤10%
- **Amber(0.90)**: −25%<Disc%<−10%
- **Red(0.75)**: Disc%≤−25%

## 破壊的変更
- 従来の4軸から3軸への変更
- テンプレート構造の大幅変更
- ワークフローの固定化
- バリデーション機能の強化

## 移行ガイド
1. 既存のテンプレートをv0.8.0対応に更新
2. 新しいスクリプトの導入
3. バリデーション機能の設定
4. テストの実行と確認

## 今後の予定
- v0.8.1: バグ修正とパフォーマンス改善
- v0.8.2: 新機能の追加
- v0.9.0: 大規模機能追加

## サポート
- ドキュメント: `README_v080.md`
- テスト: `test_ahf_v080.py`
- 実行: `Start-AHFv080Evaluation.ps1`

