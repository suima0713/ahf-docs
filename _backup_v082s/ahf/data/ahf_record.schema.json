{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "AHF Record",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "kpi": { "type": "string", "minLength": 1 },
    "period": { "type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}_(q[1-4]|fy|h[12])$" },
    "basis": { "type": "string", "enum": ["total_revenue","fees_net","n/a"], "default": "n/a" },
    "customer": { "type": "string" },
    "value": { "type": ["number","string"] },
    "unit": { "type": "string", "enum": ["USD","percent","count","text","date"] },
    "asof": { "type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}$" },
    "tag": { "type": "string", "enum": ["T1-core","T1-adj","triage.UNCERTAIN"] },
    "status": {
      "type": "string",
      "enum": [
        "not_found",
        "official_source_unconfirmed",
        "redacted",
        "future_period_not_reported",
        "not_expected_on_edgar_if_144a"
      ]
    },
    "source": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "url": { "type": "string", "minLength": 1 },
        "section": { "type": "string" }
      },
      "required": ["url"]
    },
    "url": { "type": "string" }, 
    "raw_verbatim": { "type": "string" },
    "aliases": { "type": "array", "items": { "type": "string" } },
    "notes": { "type": "array", "items": { "type": "string" } }
  },
  "oneOf": [
    { "required": ["kpi","asof","tag","value","unit","source"] },
    { "required": ["kpi","asof","tag","status","source"] }
  ]
}
