{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "AHF-Min Core Record",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "kpi": { "type": "string", "minLength": 1 },
    "value": { "type": ["number", "string", "null"] },
    "unit": { "type": "string", "enum": ["percent", "USD", "text", "count", "date", "days"] },
    "asof": { "type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}$" },
    "tag": { "type": "string", "enum": ["T1-core", "T1-adj"] },
    "url": { "type": "string" },
    "quote": { "type": "string", "maxLength": 200 },
    "section": { "type": "string" },
    "basis": { "type": "string", "enum": ["total", "fees_net", null] },
    "entity_type": { "type": "string", "enum": ["customer", "bank_partner", null] },
    "status": {
      "type": "string",
      "enum": [
        "not_expected_on_edgar_if_144a",
        "not_found",
        "future_period_not_reported",
        "redacted"
      ]
    },
    "url_index": { "type": "string" },
    "ttl_days": { "type": "integer", "minimum": 1, "maximum": 365 },
    "note": { "type": "string" },
    "offering_type_hint": { "type": "string" },
    "neg_evidence": { "type": "string" }
  },
  "oneOf": [
    {
      "description": "CONFIRMED record",
      "required": ["kpi", "unit", "asof", "tag", "url"],
      "properties": {
        "tag": { "enum": ["T1-core", "T1-adj"] },
        "value": { "type": ["number", "string", "null"] }
      }
    },
    {
      "description": "UNCERTAIN record", 
      "required": ["kpi", "status", "url_index", "ttl_days"],
      "properties": {
        "status": { "type": "string" }
      }
    }
  ]
}
